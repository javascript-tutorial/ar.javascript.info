# منحنى بيزير

منحني بيزير هو منحني يستخدم في الرسومات الحاسوبية لرسم الاشكال، الخاصة بالرسوم المتحركة باستخدام CSS و ايضا في اماكن اخري.

هناك اشياء بسيطة تستحق الدراسة مرة واحدة ثم بعد ذلك تشعر بالارتياح في عالم الرسومات المتجهةو علوم الرسوم المتحركة المتقدمة.

<<<<<<< HEAD
## نقاط التحكم
=======
```smart header="Some theory, please"
This article provides a theoretical, but very needed insight into what Bezier curves are, while [the next one](info:css-animations#bezier-curve) shows how we can use them for CSS animations.

Please take your time to read and understand the concept, it'll serve you well.
```

## Control points
>>>>>>> 9e3fa1351f80cfd6353a778a55b2c86bca9e895f

[منحنى بيزير](https://ar.wikipedia.org/wiki/%D9%85%D9%86%D8%AD%D9%86%D9%89_%D8%A8%D9%8A%D8%B2%D9%8A%D9%87) يتم تعريفه من خلال نقاط التحكم.

قد يكون هناك 2 أو 3 أو 4 أو أكثر من نقطة تحكم .

مثال علي ، منحني بنقطتين:

![](bezier2.svg)

منحني بثلاث نقاط:

![](bezier3.svg)

منحني باربع نقاط:

![](bezier4.svg)

إذا نظرت بتمعن إلى هذه المنحنيات ، يمكنك ملاحظة ذلك على الفور:

1. **النقاط ليست دائما علي المنحني.** هذا طبيعي تمامًا ، سنرى لاحقًا كيف تم بناء المنحنى.
2. **درجةالمنحنى يساوي عدد النقاط ناقص واحد**.
   بالنسبة إلى نقطتين ، لدينا منحنى خطي (خط مستقيم) ، لثلاث نقاط - منحنى تربيعي (قطع مكافئ) ، لأربع نقاط - منحنى تكعيبي.
3. **المنحني دائما بداخل [الغلاف المحدب (convex hull)](https://en.wikipedia.org/wiki/Convex_hull) من نقاط التحكم :**

   ![](bezier4-e.svg) ![](bezier3-e.svg)

Because of that last property, in computer graphics it's possible to optimize intersection tests. If convex hulls do not intersect, then curves do not either. So checking for the convex hulls intersection first can give a very fast "no intersection" result. Checking the intersection of convex hulls is much easier, because they are rectangles, triangles and so on (see the picture above), much simpler figures than the curve.

**تظهر القيمة الرئيسية لمنحنيات بيزير للرسم عن طريق تحريك النقاط التي يتغير بها المنحنى بشكل بديهي\*.**

حاول تحريك نقاط التحكم باستخدام الماوس في المثال أدناه:

[iframe src="demo.svg?nocpath=1&p=0,0,0.5,0,0.5,1,1,1" height=370]

**كما تلاحظ ، فإن المنحنى يمتد على طول خطوط الظل 1 <- 2 و 3 <- 4.**

بعد بعض التدريب ، يصبح من الواضح كيفية وضع النقاط للحصول على المنحنى المطلوب. ومن خلال ربط عدة منحنيات ، يمكننا عمليًا الحصول على أي شيء.

وهنا بعض الأمثلة:

![](bezier-car.svg) ![](bezier-letter.svg) ![](bezier-vase.svg)

## خوارزمية دي كاستيلجاو(De Casteljau's algorithm)

هناك معادلة رياضية لمنحنيات بيزير ، لكن دعونا نغطيها لاحقًا ، لأن
[خوارزمية دي كاستيلجاو (De Casteljau's algorithm) ](https://en.wikipedia.org/wiki/De_Casteljau%27s_algorithm)مطابقة للتعريف الرياضي وتظهر بصريًا كيف يتم بناؤها.

لنرى أولاً مثال النقاط الثلاث.

إليك العرض التوضيحي والتفسير التالي.

يمكن تحريك نقاط التحكم (1و2و3) بواسطة الماوس. ثم اضغط على زر "تشغيل" لتشغيله.

[iframe src="demo.svg?p=0,0,0.5,1,1,0&animate=1" height=370]

**خوارزمية دي كاستيلجاو لبناء منحني بيزير ثلاثي النقاط:**

1. ارسم نقاط تحكم ، في العرض أعلاه تم تصنيفهم: `1`, `2`, `3`.
2. قم ببناء شرائح بين نقاط التحكم 3 -> 2 ->1. في العرض أعلاه هم <span style="color:#825E28">بني</span>.
3. العلامة `t` تتحرك من `0` الي `1`. في المثال أعلاه يتم استخدام الخطوة بمقدار `0.05` : و تمر الحلقة علي `0, 0.05, 0.1, 0.15, ... 0.95, 1`.

   لكل من قيم `t`:

   - علي كل من <span style="color:#825E28">الخطوط البنية</span> نأخذ نقطة تقع على المسافة المتناسبة مع `t` من بدايتها.و نظرًا لوجود قسمين ، فلدينا نقطتان.

     على سبيل المثال ، بالنسبة لـ `t = 0` - ستكون كلتا النقطتين في بداية المقاطع ، وبالنسبة لـ` t = 0.25` ستكون على 25٪ من طول المقطع من البداية ، بالنسبة لـ `t = 0.5` ستكون في منطقة الوسط ، عند`t = 1` ستكون في نهاية المقطع.

   - قم بتوصيل النقاط. في الصورة أدناه ، تم رسم الجزء المتصل باللون <span style="color:#167490">الأزرق</span>.

| For `t=0.25`           | For `t=0.5`            |
| ---------------------- | ---------------------- |
| ![](bezier3-draw1.svg) | ![](bezier3-draw2.svg) |

4. الآن في الجزء <span style="color:#167490">الأزرق</span> خذ نقطة على المسافة متناسبة مع نفس القيمة `t`. أي بالنسبة لـ `t = 0.25` (الصورة اليسرى) لدينا نقطة في نهاية الربع الأيسر من المقطع ، وبالنسبة لـ` t = 0.5` (الصورة اليمنى) - في منتصف المقطع. على الصور أعلاه تلك النقطة <span style="color:red">حمراء</span>.

5. نظرًا لأن `t` يمتد من `0` إلى `1` ، فإن كل قيمة لـ `t` تضيف نقطة إلى المنحنى. ثم تشكل مجموعة النقاط منحنى بيزيير. إنه يظهر باللون الأحمر وعلي شكل قطع مكافئ في الصور أعلاه.

كانت هذه عملية لمنحني 3 نقاط. ولكن الشيء نفسه بالنسبة 4 نقاط.

العرض التوضيحي لـ 4 نقاط (يمكن تحريك النقاط بواسطة الماوس):

[iframe src="demo.svg?p=0,0,0.5,0,0.5,1,1,1&animate=1" height=370]

خوارزمية 4 نقاط:

- ربط نقاط التحكم بالقطاعات: 1 <- 2 ، 2 <- 3 ، 3 <- 4. سيكون هناك 3 خطوط <span style="color:#825E28">بنيه</span> .
- لكل `t` في المسافة من `0` إلى `1`:
  - نأخذ نقاطًا على هذه الأجزاء على المسافة المتناسبة مع `t` من البداية. هذه النقاط مرتبطة ببعضها البعض و لذلك يتكون لدينا خطين لونهم<span style="color:#0A0"> أخضر</span>.
  - على الخطين الأخضر نأخذ نقاطًا تتناسب مع `t`. نحصل على خط واحد <span style="color:#167490">أزرق</span>.
  - علي الخط الأزرق ناخذ نقطة تتناسب مع `t`. في المثال الأعلي لونها <span style="color:red">أحمر</span>.
- هذه النقاط معا تشكل المنحني.

الخوارزمية متكررة ويمكن تعميمها لأي عدد من نقاط التحكم.

معطى N من نقاط التحكم:

1. نقوم بتوصيلهم للحصول على عدد خطوط N-1 في البداية.
2. ثم لكل `t` من `0` إلى `1` ، نأخذ نقطة على كل جزء على المسافة المتناسبة مع `t` ونوصلهم. سيكون هناك N-2 خط.
3. نقوم بتقرار خطوة رقم 2 حتي يتبقي نقطة واحدة.

هذه النقاط معا تشكل المنحني.

```online
**قم بتشغيل الأمثلة وإيقافها  لرؤية الخطوط بوضوح وكيفية إنشاء المنحنى.**
```

منحنى الذي يشبه `y=1/t`:

[iframe src="demo.svg?p=0,0,0,0.75,0.25,1,1,1&animate=1" height=370]

المنحني المتعرج يعمل بشكل جيد:

[iframe src="demo.svg?p=0,0,1,0.5,0,0.5,1,1&animate=1" height=370]

ايضا من الممكن صنع حلقة :

[iframe src="demo.svg?p=0,0,1,0.5,0,1,0.5,0&animate=1" height=370]

منحنى بيزير غير أملس ( هذا ممكن أيضًا):

[iframe src="demo.svg?p=0,0,1,1,0,1,1,0&animate=1" height=370]

```online
إذا كان هناك شيء غير واضح في وصف الخوارزمية ، فالرجاء إلقاء نظرة على الأمثلة الحية أعلاه لمعرفة كيفية بناء المنحنى.
```

نظرًا لأن الخوارزمية تكرارية ، يمكننا بناء منحنيات بيزير بأي درجة نريد ، أي باستخدام 5 أو 6 نقاط تحكم أو أكثر. لكن من الناحية العملية ، فإن العديد من النقاط أقل فائدة. عادةً ما نأخذ 2-3 نقاط ، وبالنسبة للخطوط المعقدة نلصق عدة منحنيات معًا ، وهذا أسهل في التطوير والحساب.

```smart header="كيفية رسم منحني  *من خلال* نقاط معينة؟"
لتحديد منحنى بيزير ، يتم استخدام نقاط التحكم. كما نرى ، فهي ليست على المنحنى ، باستثناء الأول والأخير.

أحيانًا يكون لدينا مهمة أخرى: رسم منحنى *من خلال عدة نقاط* ، بحيث تكون جميعها على منحنى سلس واحد. هذه المهمة تسمى  [ استيفاء (interpolation) ](https://en.wikipedia.org/wiki/Interpolation)، وهنا لا نغطيها.

هناك معادلات رياضية لمثل هذه المنحنيات ، على سبيل المثال [كثير حدود لاغرانج (Lagrange polynomial) ](https://en.wikipedia.org/wiki/Lagrange_polynomial).فان في رسومات الحاسوب [ استيفاء الشريحة (spline interpolation) ](https://en.wikipedia.org/wiki/Spline_interpolation) غالبًا ما يستخدم لبناء منحنيات سلسة تربط العديد من النقاط.
```

## رياضيات

يمكن وصف منحنى بيزير باستخدام صيغة رياضية.

كما رأينا - ليست هناك حاجة في الواقع لمعرفة ذلك ، يقوم معظم الناس برسم المنحنى عن طريق تحريك النقاط بالماوس. ولكن إذا كنت مهتمًا بالرياضيات - ها هي.

بالنظر إلى إحداثيات نقاط التحكم <code>P<sub>i</sub></code>: أول نقطة تحكم لها إحداثيات <code>P<sub>1</sub> = (x<sub>1</sub>, y<sub>1</sub>)</code>, الثانية: <code>P<sub>2</sub> = (x<sub>2</sub>, y<sub>2</sub>)</code>, وهكذا ، يتم وصف إحداثيات المنحنى بواسطة المعادلة التي تعتمد على معامل `t` من المقطع`[1،0]`.

- صيغة منحنى ذو نقطتين:

  <code>P = (1-t)P<sub>1</sub> + tP<sub>2</sub></code>

- منحني 3 نقاط:

  <code>P = (1−t)<sup>2</sup>P<sub>1</sub> + 2(1−t)tP<sub>2</sub> + t<sup>2</sup>P<sub>3</sub></code>

- منحني 4 نقاط:

  <code>P = (1−t)<sup>3</sup>P<sub>1</sub> + 3(1−t)<sup>2</sup>tP<sub>2</sub> +3(1−t)t<sup>2</sup>P<sub>3</sub> + t<sup>3</sup>P<sub>4</sub></code>

هذه معادلات متجهة. بعبارة أخرى ، يمكننا وضع `x` و` y` بدلاً من` P` للحصول على الإحداثيات المقابلة.

على سبيل المثال ، يتكون المنحنى المكون من 3 نقاط من النقاط `` (x ، y) 'المحسوبة على النحو التالي:

- <code>x = (1−t)<sup>2</sup>x<sub>1</sub> + 2(1−t)tx<sub>2</sub> + t<sup>2</sup>x<sub>3</sub></code>
- <code>y = (1−t)<sup>2</sup>y<sub>1</sub> + 2(1−t)ty<sub>2</sub> + t<sup>2</sup>y<sub>3</sub></code>

بدلا من <code>x<sub>3</sub>, y<sub>3</sub>, x<sub>2</sub>, y<sub>2</sub>, x<sub>1</sub>, y<sub>1</sub></code> يجب أن نضع إحداثيات 3 نقاط تحكم ، ثم عندما تنتقل `t` من`0` إلى `1` ، لكل قيمة من `t` سيكون لدينا `(x,y)` للمنحنى.

على سبيل المثال ، إذا كانت نقاط التحكم `(0,0)`, `(0.5, 1)` و `(1, 0)`, تصبح المعادلات:

- <code>x = (1−t)<sup>2</sup> _ 0 + 2(1−t)t _ 0.5 + t<sup>2</sup> \* 1 = (1-t)t + t<sup>2</sup> = t</code>
- <code>y = (1−t)<sup>2</sup> _ 0 + 2(1−t)t _ 1 + t<sup>2</sup> \* 0 = 2(1-t)t = –2t<sup>2</sup> + 2t</code>

الآن نظرًا لأن `t` يمتد من `0` إلى `1` ، فإن مجموعة القيم `(x ، y)` لكل `t` تشكل المنحنى لنقاط التحكم هذه.

## الملخص

يتم تحديد منحنيات Bezier من خلال نقاط التحكم الخاصة بهم.

رأينا تعريفين لمنحنيات بيزيير:

1. باستخدام عملية الرسم: خوارزمية دي كاستيلجاو(De Casteljau’s algorithm).
2. استخدام المعدلات الرياضية.

خصائص جيدة لمنحنيات بيزير:

- يمكننا رسم خطوط ناعمة بالماوس عن طريق تحريك نقاط التحكم.
- يمكن صنع الأشكال المعقدة من عدة منحنيات بيزيير.

الاستخدام:

- في رسومات الحاسوب ، النمذجة ، محررات الرسوم المتجهة. الخطوط ايضا ممكن ان توصف بمنحنيات بيزير.
- في تطوير الويب - للرسومات على Canvas وبتنسيق SVG. بالمناسبة ، الأمثلة "الحية" أعلاه مكتوبة في SVG. إنها في الواقع مستند SVG واحد يتم إعطاؤه نقاطًا مختلفة كمعاملات. يمكنك فتحه في نافذة منفصلة ومشاهدة المصدر: [demo.svg](demo.svg?p=0,0,1,0.5,0,0.5,1,1&animate=1).
- في الرسوم المتحركة لدى CSS لوصف مسار وسرعة الرسوم المتحركة.
